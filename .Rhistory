mutate(
age_2 = parse_number(age),
ferritin_2 = parse_number(ferritin.ng.ml.),
procalcitonin_2 = parse_number(procalcitonin.ng.ml..),
lactate_2 = parse_number(lactate.mmol.l.)) %>%
select(age_2, ferritin_2, procalcitonin_2, lactate_2) %>%
na.omit()
head(df)
scatterplot <- function(df, age, contvar) {
p <- ggplot(metadata, aes_string(x = age, y = contvar, color = 'blue')) +
geom_point(size = 3) +
labs(x = 'Age', y = contvar, title = paste('Scatterplot of', age, 'and', contvar)) +
theme_classic(base_size = 5)
print(p)
}
scatterplot(df, "age_2", "ferritin_2")
df <- metadata %>%
mutate(
age_2 = parse_number(age),
ferritin_2 = parse_number(ferritin.ng.ml.),
procalcitonin_2 = parse_number(procalcitonin.ng.ml..),
lactate_2 = parse_number(lactate.mmol.l.)) %>%
select(age_2, ferritin_2, procalcitonin_2, lactate_2) %>%
na.omit()
head(df)
scatterplot <- function(df, age, contvar) {
p <- ggplot(metadata, aes_string(x = age, y = contvar)) +
geom_point(size = 3) +
labs(x = 'Age', y = contvar, title = paste('Scatterplot of', age, 'and', contvar)) +
theme_classic(base_size = 5)
print(p)
}
scatterplot(df, "age_2", "ferritin_2")
df <- metadata %>%
mutate(
age_2 = parse_number(age),
ferritin_2 = parse_number(ferritin.ng.ml.),
procalcitonin_2 = parse_number(procalcitonin.ng.ml..),
lactate_2 = parse_number(lactate.mmol.l.)) %>%
select(age_2, ferritin_2, procalcitonin_2, lactate_2) %>%
na.omit()
head(df)
scatterplot <- function(df, age, contvar) {
p <- ggplot(metadata, aes_string(x = age, y = contvar)) +
geom_point(size = 3) +
labs(x = 'Age', y = contvar, title = paste('Scatterplot of', age, 'and', contvar)) +
theme_classic(base_size = 5) +
scale_color_brewer(palette = 'Dark2') +
theme(
plot.title = element_text(size = 16, face = "bold"),
axis.title = element_text(size = 12, face = "bold"),
axis.text = element_text(size = 12),
legend.title = element_text(size = 12),
legend.text = element_text(size = 12)
)
print(p)
}
scatterplot(df, "age_2", "ferritin_2")
df <- metadata %>%
mutate(
Age = parse_number(age),
Ferritin = parse_number(ferritin.ng.ml.),
Procalcitonin = parse_number(procalcitonin.ng.ml..),
Lactate = parse_number(lactate.mmol.l.)) %>%
select(Age, Ferritin, Procalcitonin, Lactate) %>%
na.omit()
head(df)
scatterplot <- function(df, age, contvar) {
p <- ggplot(metadata, aes_string(x = age, y = contvar)) +
geom_point(size = 3) +
labs(x = 'Age', y = contvar, title = paste('Scatterplot of', age, 'and', contvar)) +
theme_classic(base_size = 5) +
scale_color_brewer(palette = 'Dark2') +
theme(
plot.title = element_text(size = 16, face = "bold"),
axis.title = element_text(size = 12, face = "bold"),
axis.text = element_text(size = 12),
legend.title = element_text(size = 12),
legend.text = element_text(size = 12)
)
print(p)
}
scatterplot(df, "Age", "Ferritin")
df <- metadata %>%
mutate(
Age = parse_number(age),
Ferritin = parse_number(ferritin.ng.ml.),
Procalcitonin = parse_number(procalcitonin.ng.ml..),
Lactate = parse_number(lactate.mmol.l.)) %>%
select(Age, Ferritin, Procalcitonin, Lactate) %>%
na.omit()
head(df)
scatterplot <- function(df, age, contvar) {
p <- ggplot(metadata, aes_string(x = age, y = contvar)) +
geom_point(size = 3) +
labs(x = 'Age', y = contvar, title = paste('Scatterplot of', age, 'and', contvar)) +
theme_classic(base_size = 5) +
scale_color_brewer(palette = 'Dark2') +
theme(
plot.title = element_text(size = 16, face = "bold"),
axis.title = element_text(size = 12, face = "bold"),
axis.text = element_text(size = 12),
legend.title = element_text(size = 12),
legend.text = element_text(size = 12)
)
print(p)
}
scatterplot(df, "Age", "Ferritin")
df <- metadata %>%
mutate(
Age = parse_number(age),
Ferritin_2 = parse_number(ferritin.ng.ml.),
Procalcitonin = parse_number(procalcitonin.ng.ml..),
Lactate = parse_number(lactate.mmol.l.)) %>%
select(Age, Ferritin, Procalcitonin, Lactate) %>%
na.omit()
df <- metadata %>%
mutate(
Age = parse_number(age),
Ferritin = parse_number(ferritin.ng.ml.),
Procalcitonin = parse_number(procalcitonin.ng.ml..),
Lactate = parse_number(lactate.mmol.l.)) %>%
select(Age, Ferritin, Procalcitonin, Lactate) %>%
na.omit()
head(df)
scatterplot <- function(df, age, contvar) {
p <- ggplot(metadata, aes_string(x = age, y = contvar)) +
geom_point(size = 3) +
labs(x = 'Age', y = contvar, title = paste('Scatterplot of', age, 'and', contvar)) +
theme_classic(base_size = 5) +
scale_color_brewer(palette = 'Dark2') +
theme(
plot.title = element_text(size = 16, face = "bold"),
axis.title = element_text(size = 12, face = "bold"),
axis.text = element_text(size = 12),
legend.title = element_text(size = 12),
legend.text = element_text(size = 12)
)
print(p)
}
scatterplot(df, "Age", "Ferritin_2")
df <- metadata %>%
mutate(
Age = parse_number(age),
Ferritin = parse_number(ferritin.ng.ml.),
Procalcitonin = parse_number(procalcitonin.ng.ml..),
Lactate = parse_number(lactate.mmol.l.)) %>%
select(Age, Ferritin, Procalcitonin, Lactate) %>%
na.omit()
head(df)
scatterplot <- function(df, age, contvar) {
p <- ggplot(metadata, aes_string(x = age, y = contvar)) +
geom_point(size = 3) +
labs(x = 'Age', y = contvar, title = paste('Scatterplot of', age, 'and', contvar)) +
theme_classic(base_size = 5) +
scale_color_brewer(palette = 'Dark2') +
theme(
plot.title = element_text(size = 16, face = "bold"),
axis.title = element_text(size = 12, face = "bold"),
axis.text = element_text(size = 12),
legend.title = element_text(size = 12),
legend.text = element_text(size = 12)
)
print(p)
}
scatterplot(df, "Age", "Ferritin")
df <- metadata %>%
mutate(
Age = parse_number(age),
Ferritin = parse_number(ferritin.ng.ml.),
Procalcitonin = parse_number(procalcitonin.ng.ml..),
Lactate = parse_number(lactate.mmol.l.)) %>%
select(Age, Ferritin, Procalcitonin, Lactate) %>%
na.omit()
scatterplot <- function(df, age, contvar) {
p <- ggplot(df, aes_string(x = age, y = contvar)) +
geom_point(size = 3) +
labs(x = 'Age', y = contvar, title = paste('Scatterplot of', age, 'and', contvar)) +
theme_classic(base_size = 5) +
scale_color_brewer(palette = 'Dark2') +
theme(
plot.title = element_text(size = 16, face = "bold"),
axis.title = element_text(size = 12, face = "bold"),
axis.text = element_text(size = 12),
legend.title = element_text(size = 12),
legend.text = element_text(size = 12)
)
print(p)
}
# Calling the scatterplot function
scatterplot(df, "Age", "Ferritin")
df <- metadata %>%
mutate(
Age = parse_number(age),
Ferritin = parse_number(ferritin.ng.ml.),
Procalcitonin = parse_number(procalcitonin.ng.ml..),
Lactate = parse_number(lactate.mmol.l.)) %>%
select(Age, Ferritin, Procalcitonin, Lactate) %>%
na.omit()
scatterplot <- function(df, age, contvar) {
p <- ggplot(df, aes_string(x = age, y = contvar)) +
geom_point(size = 3, color = 'blue') +
labs(x = 'Age', y = contvar, title = paste('Scatterplot of', age, 'and', contvar)) +
theme_classic(base_size = 5) +
theme(
plot.title = element_text(size = 16, face = "bold"),
axis.title = element_text(size = 12, face = "bold"),
axis.text = element_text(size = 12),
legend.title = element_text(size = 12),
legend.text = element_text(size = 12)
)
print(p)
}
# Calling the scatterplot function
scatterplot(df, "Age", "Ferritin")
df <- metadata %>%
mutate(
Age = parse_number(age),
Ferritin = parse_number(ferritin.ng.ml.),
Procalcitonin = parse_number(procalcitonin.ng.ml..),
Lactate = parse_number(lactate.mmol.l.)) %>%
select(Age, Ferritin, Procalcitonin, Lactate) %>%
na.omit()
scatterplot <- function(df, age, contvar) {
p <- ggplot(df, aes_string(x = age, y = contvar)) +
geom_point(size = 3, color = 'blue') +
labs(x = 'Age (Years)', y = contvar, title = paste('Scatterplot of', age, 'and', contvar)) +
geom_hline(yintercept = y_mean, color = "red", size = 1) +  # Mean line
geom_hline(yintercept = y_mean + y_sd, linetype = "dashed", color = "blue") +  # Mean + 1 SD
geom_hline(yintercept = y_mean - y_sd, linetype = "dashed", color = "blue") +  # Mean - 1 SD
theme_classic(base_size = 5) +
theme(
plot.title = element_text(size = 16, face = "bold"),
axis.title = element_text(size = 12, face = "bold"),
axis.text = element_text(size = 12),
legend.title = element_text(size = 12),
legend.text = element_text(size = 12)
)
print(p)
}
# Calling the scatterplot function
scatterplot(df, "Age", "Ferritin")
df <- metadata %>%
mutate(
Age = parse_number(age),
Ferritin = parse_number(ferritin.ng.ml.),
Procalcitonin = parse_number(procalcitonin.ng.ml..),
Lactate = parse_number(lactate.mmol.l.)) %>%
select(Age, Ferritin, Procalcitonin, Lactate) %>%
na.omit()
scatterplot <- function(df, age, contvar) {
#calc means and stdev
y_mean <- mean(df[[contvar]], na.rm = TRUE)
y_sd <- sd(df[[contvar]], na.rm = TRUE)
p <- ggplot(df, aes_string(x = age, y = contvar)) +
geom_point(size = 3, color = 'blue') +
labs(x = 'Age (Years)', y = contvar, title = paste('Scatterplot of', age, 'and', contvar)) +
geom_hline(yintercept = y_mean, color = "red", size = 1) +  # Mean line
geom_hline(yintercept = y_mean + y_sd, linetype = "dashed", color = "blue") +  # Mean + 1 SD
geom_hline(yintercept = y_mean - y_sd, linetype = "dashed", color = "blue") +  # Mean - 1 SD
theme_classic(base_size = 5) +
theme(
plot.title = element_text(size = 16, face = "bold"),
axis.title = element_text(size = 12, face = "bold"),
axis.text = element_text(size = 12),
legend.title = element_text(size = 12),
legend.text = element_text(size = 12)
)
print(p)
}
# Calling the scatterplot function
scatterplot(df, "Age", "Ferritin")
#still need to add the units to the y axis
df <- metadata %>%
mutate(
Age = parse_number(age),
Ferritin = parse_number(ferritin.ng.ml.),
Procalcitonin = parse_number(procalcitonin.ng.ml..),
Lactate = parse_number(lactate.mmol.l.)) %>%
select(Age, Ferritin, Procalcitonin, Lactate) %>%
na.omit()
scatterplot <- function(df, age, contvar) {
#calc means and stdev
y_mean <- mean(df[[contvar]], na.rm = TRUE)
y_sd <- sd(df[[contvar]], na.rm = TRUE)
p <- ggplot(df, aes_string(x = age, y = contvar)) +
geom_point(size = 3, color = 'blue') +
labs(x = 'Age (Years)', y = contvar, title = paste('Scatterplot of', age, 'and', contvar)) +
geom_hline(yintercept = y_mean, color = "red", size = 1) +  # Mean line
geom_hline(yintercept = y_mean + y_sd, linetype = "dashed", color = "blue") +  # Mean + 1 SD
geom_hline(yintercept = y_mean - y_sd, linetype = "dashed", color = "blue") +  # Mean - 1 SD
theme_classic(base_size = 5) +
theme(
plot.title = element_text(size = 16, face = "bold", hjust = 0.5),
axis.title = element_text(size = 12, face = "bold"),
axis.text = element_text(size = 12),
legend.title = element_text(size = 12),
legend.text = element_text(size = 12)
)
print(p)
}
# Calling the scatterplot function
scatterplot(df, "Age", "Ferritin")
#still need to add the units to the y axis
df <- metadata %>%
mutate(
Age = parse_number(age),
Ferritin = parse_number(ferritin.ng.ml.),
Procalcitonin = parse_number(procalcitonin.ng.ml..),
Lactate = parse_number(lactate.mmol.l.)) %>%
select(Age, Ferritin, Procalcitonin, Lactate) %>%
na.omit()
scatterplot <- function(df, age, contvar) {
#calc means and stdev
y_mean <- mean(df[[contvar]], na.rm = TRUE)
y_sd <- sd(df[[contvar]], na.rm = TRUE)
p <- ggplot(df, aes_string(x = age, y = contvar)) +
geom_point(size = 3, color = 'blue') +
labs(x = 'Age (Years)', y = contvar, title = paste('Scatterplot of', age, 'and', contvar)) +
geom_hline(yintercept = y_mean, color = "red", size = 1) +  # Mean line
geom_hline(yintercept = y_mean + y_sd, linetype = "dashed", color = "blue") +  # Mean + 1 SD
geom_hline(yintercept = y_mean - y_sd, linetype = "dashed", color = "blue") +  # Mean - 1 SD
theme_classic(base_size = 5) +
theme(
plot.title = element_text(size = 16, face = "bold", hjust = 0.5),
axis.title = element_text(size = 12, face = "bold"),
axis.text = element_text(size = 12),
legend.title = element_text(size = 12),
legend.text = element_text(size = 12)
)
print(p)
}
# Calling the scatterplot function
vars <- c('Ferritin','Procalcitonin', 'Lactate')
for (var in vars) {
scatterplot_func(df,'Age', var)
}
df <- metadata %>%
mutate(
Age = parse_number(age),
Ferritin = parse_number(ferritin.ng.ml.),
Procalcitonin = parse_number(procalcitonin.ng.ml..),
Lactate = parse_number(lactate.mmol.l.)) %>%
select(Age, Ferritin, Procalcitonin, Lactate) %>%
na.omit()
scatterplot <- function(df, age, contvar) {
#calc means and stdev
y_mean <- mean(df[[contvar]], na.rm = TRUE)
y_sd <- sd(df[[contvar]], na.rm = TRUE)
p <- ggplot(df, aes_string(x = age, y = contvar)) +
geom_point(size = 3, color = 'blue') +
labs(x = 'Age (Years)', y = contvar, title = paste('Scatterplot of', age, 'and', contvar)) +
geom_hline(yintercept = y_mean, color = "red", size = 1) +  # Mean line
geom_hline(yintercept = y_mean + y_sd, linetype = "dashed", color = "blue") +  # Mean + 1 SD
geom_hline(yintercept = y_mean - y_sd, linetype = "dashed", color = "blue") +  # Mean - 1 SD
theme_classic(base_size = 5) +
theme(
plot.title = element_text(size = 16, face = "bold", hjust = 0.5),
axis.title = element_text(size = 12, face = "bold"),
axis.text = element_text(size = 12),
legend.title = element_text(size = 12),
legend.text = element_text(size = 12)
)
print(p)
}
# Calling the scatterplot function
vars <- c('Ferritin','Procalcitonin', 'Lactate')
for (var in vars) {
scatterplot(df,'Age', var)
}
#still need to add the units to the y axis
df <- metadata %>%
mutate(
Age = parse_number(age),
Ferritin = parse_number(ferritin.ng.ml.),
Procalcitonin = parse_number(procalcitonin.ng.ml..),
Lactate = parse_number(lactate.mmol.l.)) %>%
select(Age, Ferritin, Procalcitonin, Lactate) %>%
na.omit()
scatterplot <- function(df, age, contvar, unit) {
#calc means and stdev
y_mean <- mean(df[[contvar]], na.rm = TRUE)
y_sd <- sd(df[[contvar]], na.rm = TRUE)
p <- ggplot(df, aes_string(x = age, y = contvar)) +
geom_point(size = 3, color = 'blue') +
labs(x = 'Age (Years)', y = paste(contvar, unit), title = paste('Scatterplot of', age, 'and', contvar)) +
geom_hline(yintercept = y_mean, color = "red", size = 1) +  # Mean line
geom_hline(yintercept = y_mean + y_sd, linetype = "dashed", color = "blue") +  # Mean + 1 SD
geom_hline(yintercept = y_mean - y_sd, linetype = "dashed", color = "blue") +  # Mean - 1 SD
theme_classic(base_size = 5) +
theme(
plot.title = element_text(size = 16, face = "bold", hjust = 0.5),
axis.title = element_text(size = 12, face = "bold"),
axis.text = element_text(size = 12),
legend.title = element_text(size = 12),
legend.text = element_text(size = 12)
)
print(p)
}
# Calling the scatterplot function
vars <- c('Ferritin','Procalcitonin', 'Lactate')
units <- c('(ng/mL)', '(ng/mL)', '(mmol/l)')
for (i in seq_along(vars)) {
scatterplot(df, 'Age', vars[i], units[i])
}
df <- metadata %>%
mutate(
Age = parse_number(age),
Ferritin = parse_number(ferritin.ng.ml.),
Procalcitonin = parse_number(procalcitonin.ng.ml..),
Lactate = parse_number(lactate.mmol.l.)) %>%
select(Age, Ferritin, Procalcitonin, Lactate) %>%
na.omit()
scatterplot <- function(df, age, contvar, unit) {
#calc means and stdev
y_mean <- mean(df[[contvar]], na.rm = TRUE)
y_sd <- sd(df[[contvar]], na.rm = TRUE)
p <- ggplot(df, aes_string(x = age, y = contvar)) +
geom_point(size = 3, color = 'cyan4') +
labs(x = 'Age (Years)', y = paste(contvar, unit), title = paste('Scatterplot of', age, 'and', contvar)) +
geom_hline(yintercept = y_mean, color = "red", size = 1) +  # Mean line
geom_hline(yintercept = y_mean + y_sd, linetype = "dashed", color = "blue") +  # Mean + 1 SD
geom_hline(yintercept = y_mean - y_sd, linetype = "dashed", color = "blue") +  # Mean - 1 SD
theme_classic(base_size = 5) +
theme(
plot.title = element_text(size = 16, face = "bold", hjust = 0.5),
axis.title = element_text(size = 12, face = "bold"),
axis.text = element_text(size = 12),
legend.title = element_text(size = 12),
legend.text = element_text(size = 12)
)
print(p)
}
# Calling the scatterplot function
vars <- c('Ferritin','Procalcitonin', 'Lactate')
units <- c('(ng/mL)', '(ng/mL)', '(mmol/l)')
for (i in seq_along(vars)) {
scatterplot(df, 'Age', vars[i], units[i])
}
df <- metadata %>%
mutate(
Age = parse_number(age),
Ferritin = parse_number(ferritin.ng.ml.),
Procalcitonin = parse_number(procalcitonin.ng.ml..),
Lactate = parse_number(lactate.mmol.l.)) %>%
select(Age, Ferritin, Procalcitonin, Lactate) %>%
na.omit()
scatterplot <- function(df, age, contvar, unit) {
#calc means and stdev
y_mean <- mean(df[[contvar]], na.rm = TRUE)
y_sd <- sd(df[[contvar]], na.rm = TRUE)
p <- ggplot(df, aes_string(x = age, y = contvar)) +
geom_point(size = 3, color = 'cyan4') +
labs(x = 'Age (Years)', y = paste(contvar, unit), title = paste('Scatterplot of', age, 'and', contvar)) +
geom_hline(yintercept = y_mean, color = "red", size = 1) +  # Mean line
geom_hline(yintercept = y_mean + y_sd, linetype = "dashed", color = "aquamarine4") +  # Mean + 1 SD
geom_hline(yintercept = y_mean - y_sd, linetype = "dashed", color = "aquamarine4") +  # Mean - 1 SD
theme_classic(base_size = 5) +
theme(
plot.title = element_text(size = 16, face = "bold", hjust = 0.5),
axis.title = element_text(size = 12, face = "bold"),
axis.text = element_text(size = 12),
legend.title = element_text(size = 12),
legend.text = element_text(size = 12)
)
print(p)
}
# Calling the scatterplot function
vars <- c('Ferritin','Procalcitonin', 'Lactate')
units <- c('(ng/mL)', '(ng/mL)', '(mmol/l)')
for (i in seq_along(vars)) {
scatterplot(df, 'Age', vars[i], units[i])
}
df <- metadata %>%
mutate(
Age = parse_number(age),
Ferritin = parse_number(ferritin.ng.ml.),
Procalcitonin = parse_number(procalcitonin.ng.ml..),
Lactate = parse_number(lactate.mmol.l.)) %>%
select(Age, Ferritin, Procalcitonin, Lactate) %>%
na.omit()
scatterplot <- function(df, age, contvar, unit) {
#calc means and stdev
y_mean <- mean(df[[contvar]], na.rm = TRUE)
y_sd <- sd(df[[contvar]], na.rm = TRUE)
p <- ggplot(df, aes_string(x = age, y = contvar)) +
geom_point(size = 3, color = 'cyan4') +
labs(x = 'Age (Years)', y = paste(contvar, unit), title = paste('Scatterplot of', age, 'and', contvar)) +
geom_hline(yintercept = y_mean, color = "coral2", size = 1) +  # Mean line
geom_hline(yintercept = y_mean + y_sd, linetype = "dashed", color = "aquamarine4") +  # Mean + 1 SD
geom_hline(yintercept = y_mean - y_sd, linetype = "dashed", color = "aquamarine4") +  # Mean - 1 SD
theme_classic(base_size = 5) +
theme(
plot.title = element_text(size = 16, face = "bold", hjust = 0.5),
axis.title = element_text(size = 12, face = "bold"),
axis.text = element_text(size = 12),
legend.title = element_text(size = 12),
legend.text = element_text(size = 12)
)
print(p)
}
# Calling the scatterplot function
vars <- c('Ferritin','Procalcitonin', 'Lactate')
units <- c('(ng/mL)', '(ng/mL)', '(mmol/l)')
for (i in seq_along(vars)) {
scatterplot(df, 'Age', vars[i], units[i])
}
knitr::opts_chunk$set(echo = TRUE)
#read in data!
setwd("C:/Users/AlexandraTreml/Desktop/MS/QBS103/Assignments")
# genes <- read.csv("genes_GSE157103.csv")
metadata <- read.csv("series_matrix_GSE157103.csv")
